{"id":"2412.09563","title":"Does Representation Matter? Exploring Intermediate Layers in Large\n  Language Models","authors":"Oscar Skean, Md Rifat Arefin, Yann LeCun, Ravid Shwartz-Ziv","authorsParsed":[["Skean","Oscar",""],["Arefin","Md Rifat",""],["LeCun","Yann",""],["Shwartz-Ziv","Ravid",""]],"versions":[{"version":"v1","created":"Thu, 12 Dec 2024 18:48:51 GMT"}],"updateDate":"2024-12-13","timestamp":1734029331000,"abstract":"  Understanding what defines a good representation in large language models\n(LLMs) is fundamental to both theoretical understanding and practical\napplications. In this paper, we investigate the quality of intermediate\nrepresentations in various LLM architectures, including Transformers and State\nSpace Models (SSMs). We find that intermediate layers often yield more\ninformative representations for downstream tasks than the final layers. To\nmeasure the representation quality, we adapt and apply a suite of metrics -\nsuch as prompt entropy, curvature, and augmentation-invariance - originally\nproposed in other contexts. Our empirical study reveals significant\narchitectural differences, how representations evolve throughout training, and\nhow factors like input randomness and prompt length affect each layer. Notably,\nwe observe a bimodal pattern in the entropy of some intermediate layers and\nconsider potential explanations tied to training data. Overall, our results\nilluminate the internal mechanics of LLMs and guide strategies for\narchitectural optimization and training.\n","subjects":["Computer Science/Machine Learning","Computer Science/Computation and Language"],"license":"http://creativecommons.org/licenses/by-sa/4.0/","blobId":"cJHKBGLLquieiwqcNk3j_roZQjgrCBfYPZP_XKzyQRU","pdfSize":"967003"}