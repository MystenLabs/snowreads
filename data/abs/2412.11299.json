{
  "id": "2412.11299",
  "title": "How not to Stitch Representations to Measure Similarity: Task Loss\n  Matching versus Direct Matching",
  "authors": "Andr\\'as Balogh, M\\'ark Jelasity",
  "authorsParsed": [
    [
      "Balogh",
      "András",
      ""
    ],
    [
      "Jelasity",
      "Márk",
      ""
    ]
  ],
  "versions": [
    {
      "version": "v1",
      "created": "Sun, 15 Dec 2024 20:18:49 GMT"
    }
  ],
  "updateDate": "2024-12-17",
  "timestamp": 1734293929000,
  "abstract": "  Measuring the similarity of the internal representations of deep neural\nnetworks is an important and challenging problem. Model stitching has been\nproposed as a possible approach, where two half-networks are connected by\nmapping the output of the first half-network to the input of the second one.\nThe representations are considered functionally similar if the resulting\nstitched network achieves good task-specific performance. The mapping is\nnormally created by training an affine stitching layer on the task at hand\nwhile freezing the two half-networks, a method called task loss matching. Here,\nwe argue that task loss matching may be very misleading as a similarity index.\nFor example, it can indicate very high similarity between very distant layers,\nwhose representations are known to have different functional properties.\nMoreover, it can indicate very distant layers to be more similar than\narchitecturally corresponding layers. Even more surprisingly, when comparing\nlayers within the same network, task loss matching often indicates that some\nlayers are more similar to a layer than itself. We argue that the main reason\nbehind these problems is that task loss matching tends to create\nout-of-distribution representations to improve task-specific performance. We\ndemonstrate that direct matching (when the mapping minimizes the distance\nbetween the stitched representations) does not suffer from these problems. We\ncompare task loss matching, direct matching, and well-known similarity indices\nsuch as CCA and CKA. We conclude that direct matching strikes a good balance\nbetween the structural and functional requirements for a good similarity index.\n",
  "subjects": [
    "Computer Science/Machine Learning",
    "Statistics/Machine Learning"
  ],
  "license": "http://creativecommons.org/licenses/by-sa/4.0/",
  "blobId": "MfH99pe2_T7iI75JrtV9dJS1_VpGhKip-QEpJ9_8u-A",
  "pdfSize": "642937"
}