{"id":"2408.14621","title":"Instrumenting Transaction Trace Properties in Smart Contracts: Extending\n  the EVM for Real-Time Security","authors":"Zhiyang Chen, Jan Gorzny, Martin Derka","authorsParsed":[["Chen","Zhiyang",""],["Gorzny","Jan",""],["Derka","Martin",""]],"versions":[{"version":"v1","created":"Mon, 26 Aug 2024 20:33:22 GMT"}],"updateDate":"2024-08-28","timestamp":1724704402000,"abstract":"  In the realm of smart contract security, transaction malice detection has\nbeen able to leverage properties of transaction traces to identify hacks with\nhigh accuracy. However, these methods cannot be applied in real-time to revert\nmalicious transactions. Instead, smart contracts are often instrumented with\nsome safety properties to enhance their security. However, these instrumentable\nsafety properties are limited and fail to block certain types of hacks such as\nthose which exploit read-only re-entrancy. This limitation primarily stems from\nthe Ethereum Virtual Machine's (EVM) inability to allow a smart contract to\nread transaction traces in real-time. Additionally, these instrumentable safety\nproperties can be gas-intensive, rendering them impractical for on-the-fly\nvalidation. To address these challenges, we propose modifications to both the\nEVM and Ethereum clients, enabling smart contracts to validate these\ntransaction trace properties in real-time without affecting traditional EVM\nexecution. We also use past-time linear temporal logic (PLTL) to formalize\ntransaction trace properties, showcasing that most existing detection metrics\ncan be expressed using PLTL. We also discuss the potential implications of our\nproposed modifications, emphasizing their capacity to significantly enhance\nsmart contract security.\n","subjects":["Computing Research Repository/Logic in Computer Science","Computing Research Repository/Cryptography and Security"],"license":"http://creativecommons.org/licenses/by-nc-sa/4.0/"}