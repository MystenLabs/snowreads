{"id":"2408.14158","title":"Fire-Flyer AI-HPC: A Cost-Effective Software-Hardware Co-Design for Deep\n  Learning","authors":"Wei An, Xiao Bi, Guanting Chen, Shanhuang Chen, Chengqi Deng, Honghui\n  Ding, Kai Dong, Qiushi Du, Wenjun Gao, Kang Guan, Jianzhong Guo, Yongqiang\n  Guo, Zhe Fu, Ying He, Panpan Huang, Jiashi Li, Wenfeng Liang, Xiaodong Liu,\n  Xin Liu, Yiyuan Liu, Yuxuan Liu, Shanghao Lu, Xuan Lu, Xiaotao Nie, Tian Pei,\n  Junjie Qiu, Hui Qu, Zehui Ren, Zhangli Sha, Xuecheng Su, Xiaowen Sun, Yixuan\n  Tan, Minghui Tang, Shiyu Wang, Yaohui Wang, Yongji Wang, Ziwei Xie, Yiliang\n  Xiong, Yanhong Xu, Shengfeng Ye, Shuiping Yu, Yukun Zha, Liyue Zhang, Haowei\n  Zhang, Mingchuan Zhang, Wentao Zhang, Yichao Zhang, Chenggang Zhao, Yao Zhao,\n  Shangyan Zhou, Shunfeng Zhou, Yuheng Zou","authorsParsed":[["An","Wei",""],["Bi","Xiao",""],["Chen","Guanting",""],["Chen","Shanhuang",""],["Deng","Chengqi",""],["Ding","Honghui",""],["Dong","Kai",""],["Du","Qiushi",""],["Gao","Wenjun",""],["Guan","Kang",""],["Guo","Jianzhong",""],["Guo","Yongqiang",""],["Fu","Zhe",""],["He","Ying",""],["Huang","Panpan",""],["Li","Jiashi",""],["Liang","Wenfeng",""],["Liu","Xiaodong",""],["Liu","Xin",""],["Liu","Yiyuan",""],["Liu","Yuxuan",""],["Lu","Shanghao",""],["Lu","Xuan",""],["Nie","Xiaotao",""],["Pei","Tian",""],["Qiu","Junjie",""],["Qu","Hui",""],["Ren","Zehui",""],["Sha","Zhangli",""],["Su","Xuecheng",""],["Sun","Xiaowen",""],["Tan","Yixuan",""],["Tang","Minghui",""],["Wang","Shiyu",""],["Wang","Yaohui",""],["Wang","Yongji",""],["Xie","Ziwei",""],["Xiong","Yiliang",""],["Xu","Yanhong",""],["Ye","Shengfeng",""],["Yu","Shuiping",""],["Zha","Yukun",""],["Zhang","Liyue",""],["Zhang","Haowei",""],["Zhang","Mingchuan",""],["Zhang","Wentao",""],["Zhang","Yichao",""],["Zhao","Chenggang",""],["Zhao","Yao",""],["Zhou","Shangyan",""],["Zhou","Shunfeng",""],["Zou","Yuheng",""]],"versions":[{"version":"v1","created":"Mon, 26 Aug 2024 10:11:56 GMT"},{"version":"v2","created":"Sat, 31 Aug 2024 13:33:22 GMT"}],"updateDate":"2024-09-04","timestamp":1724667116000,"abstract":"  The rapid progress in Deep Learning (DL) and Large Language Models (LLMs) has\nexponentially increased demands of computational power and bandwidth. This,\ncombined with the high costs of faster computing chips and interconnects, has\nsignificantly inflated High Performance Computing (HPC) construction costs. To\naddress these challenges, we introduce the Fire-Flyer AI-HPC architecture, a\nsynergistic hardware-software co-design framework and its best practices. For\nDL training, we deployed the Fire-Flyer 2 with 10,000 PCIe A100 GPUs, achieved\nperformance approximating the DGX-A100 while reducing costs by half and energy\nconsumption by 40%. We specifically engineered HFReduce to accelerate allreduce\ncommunication and implemented numerous measures to keep our Computation-Storage\nIntegrated Network congestion-free. Through our software stack, including\nHaiScale, 3FS, and HAI-Platform, we achieved substantial scalability by\noverlapping computation and communication. Our system-oriented experience from\nDL training provides valuable insights to drive future advancements in AI-HPC.\n","subjects":["Computing Research Repository/Distributed, Parallel, and Cluster Computing","Computing Research Repository/Artificial Intelligence"],"license":"http://arxiv.org/licenses/nonexclusive-distrib/1.0/"}