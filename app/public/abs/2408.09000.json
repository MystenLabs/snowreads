{"id":"2408.09000","title":"Classifier-Free Guidance is a Predictor-Corrector","authors":"Arwen Bradley, Preetum Nakkiran","authorsParsed":[["Bradley","Arwen",""],["Nakkiran","Preetum",""]],"versions":[{"version":"v1","created":"Fri, 16 Aug 2024 20:00:55 GMT"},{"version":"v2","created":"Fri, 23 Aug 2024 17:21:35 GMT"}],"updateDate":"2024-08-26","timestamp":1723838455000,"abstract":"  We investigate the theoretical foundations of classifier-free guidance (CFG).\nCFG is the dominant method of conditional sampling for text-to-image diffusion\nmodels, yet unlike other aspects of diffusion, it remains on shaky theoretical\nfooting. In this paper, we disprove common misconceptions, by showing that CFG\ninteracts differently with DDPM (Ho et al., 2020) and DDIM (Song et al., 2021),\nand neither sampler with CFG generates the gamma-powered distribution\n$p(x|c)^\\gamma p(x)^{1-\\gamma}$. Then, we clarify the behavior of CFG by\nshowing that it is a kind of predictor-corrector method (Song et al., 2020)\nthat alternates between denoising and sharpening, which we call\npredictor-corrector guidance (PCG). We prove that in the SDE limit, CFG is\nactually equivalent to combining a DDIM predictor for the conditional\ndistribution together with a Langevin dynamics corrector for a gamma-powered\ndistribution (with a carefully chosen gamma). Our work thus provides a lens to\ntheoretically understand CFG by embedding it in a broader design space of\nprincipled sampling methods.\n","subjects":["Computing Research Repository/Machine Learning","Computing Research Repository/Artificial Intelligence","Computing Research Repository/Computer Vision and Pattern Recognition"],"license":"http://arxiv.org/licenses/nonexclusive-distrib/1.0/"}