{"id":"2407.01529","title":"On the Abuse and Detection of Polyglot Files","authors":"Luke Koch, Sean Oesch, Amul Chaulagain, Jared Dixon, Matthew Dixon,\n  Mike Huettal, Amir Sadovnik, Cory Watson, Brian Weber, Jacob Hartman, Richard\n  Patulski","authorsParsed":[["Koch","Luke",""],["Oesch","Sean",""],["Chaulagain","Amul",""],["Dixon","Jared",""],["Dixon","Matthew",""],["Huettal","Mike",""],["Sadovnik","Amir",""],["Watson","Cory",""],["Weber","Brian",""],["Hartman","Jacob",""],["Patulski","Richard",""]],"versions":[{"version":"v1","created":"Mon, 1 Jul 2024 17:59:54 GMT"}],"updateDate":"2024-07-02","timestamp":1719856794000,"abstract":"  A polyglot is a file that is valid in two or more formats. Polyglot files\npose a problem for malware detection systems that route files to\nformat-specific detectors/signatures, as well as file upload and sanitization\ntools. In this work we found that existing file-format and embedded-file\ndetection tools, even those developed specifically for polyglot files, fail to\nreliably detect polyglot files used in the wild, leaving organizations\nvulnerable to attack. To address this issue, we studied the use of polyglot\nfiles by malicious actors in the wild, finding $30$ polyglot samples and $15$\nattack chains that leveraged polyglot files. In this report, we highlight two\nwell-known APTs whose cyber attack chains relied on polyglot files to bypass\ndetection mechanisms. Using knowledge from our survey of polyglot usage in the\nwild -- the first of its kind -- we created a novel data set based on adversary\ntechniques. We then trained a machine learning detection solution, PolyConv,\nusing this data set. PolyConv achieves a precision-recall area-under-curve\nscore of $0.999$ with an F1 score of $99.20$% for polyglot detection and\n$99.47$% for file-format identification, significantly outperforming all other\ntools tested. We developed a content disarmament and reconstruction tool,\nImSan, that successfully sanitized $100$% of the tested image-based polyglots,\nwhich were the most common type found via the survey. Our work provides\nconcrete tools and suggestions to enable defenders to better defend themselves\nagainst polyglot files, as well as directions for future work to create more\nrobust file specifications and methods of disarmament.\n","subjects":["Computing Research Repository/Cryptography and Security","Computing Research Repository/Machine Learning"],"license":"http://arxiv.org/licenses/nonexclusive-distrib/1.0/"}