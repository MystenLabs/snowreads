{"id":"2407.09025","title":"SpreadsheetLLM: Encoding Spreadsheets for Large Language Models","authors":"Yuzhang Tian, Jianbo Zhao, Haoyu Dong, Junyu Xiong, Shiyu Xia, Mengyu\n  Zhou, Yun Lin, Jos\\'e Cambronero, Yeye He, Shi Han, Dongmei Zhang","authorsParsed":[["Tian","Yuzhang",""],["Zhao","Jianbo",""],["Dong","Haoyu",""],["Xiong","Junyu",""],["Xia","Shiyu",""],["Zhou","Mengyu",""],["Lin","Yun",""],["Cambronero","Jos√©",""],["He","Yeye",""],["Han","Shi",""],["Zhang","Dongmei",""]],"versions":[{"version":"v1","created":"Fri, 12 Jul 2024 06:34:21 GMT"}],"updateDate":"2024-07-15","timestamp":1720766061000,"abstract":"  Spreadsheets, with their extensive two-dimensional grids, various layouts,\nand diverse formatting options, present notable challenges for large language\nmodels (LLMs). In response, we introduce SpreadsheetLLM, pioneering an\nefficient encoding method designed to unleash and optimize LLMs' powerful\nunderstanding and reasoning capability on spreadsheets. Initially, we propose a\nvanilla serialization approach that incorporates cell addresses, values, and\nformats. However, this approach was limited by LLMs' token constraints, making\nit impractical for most applications. To tackle this challenge, we develop\nSheetCompressor, an innovative encoding framework that compresses spreadsheets\neffectively for LLMs. It comprises three modules: structural-anchor-based\ncompression, inverse index translation, and data-format-aware aggregation. It\nsignificantly improves performance in spreadsheet table detection task,\noutperforming the vanilla approach by 25.6% in GPT4's in-context learning\nsetting. Moreover, fine-tuned LLM with SheetCompressor has an average\ncompression ratio of 25 times, but achieves a state-of-the-art 78.9% F1 score,\nsurpassing the best existing models by 12.3%. Finally, we propose Chain of\nSpreadsheet for downstream tasks of spreadsheet understanding and validate in a\nnew and demanding spreadsheet QA task. We methodically leverage the inherent\nlayout and structure of spreadsheets, demonstrating that SpreadsheetLLM is\nhighly effective across a variety of spreadsheet tasks.\n","subjects":["Computing Research Repository/Artificial Intelligence"],"license":"http://arxiv.org/licenses/nonexclusive-distrib/1.0/"}